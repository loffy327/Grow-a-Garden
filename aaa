
local MenuLibrary = {}

-- Hàm khởi tạo GUI
function MenuLibrary:CreateMenu(player)
	local playerGui = player:WaitForChild("PlayerGui")

	-- ========== MENU NHỎ ==========
	local smallMenu = Instance.new("ScreenGui")
	smallMenu.Name = "SmallMenu"
	smallMenu.ResetOnSpawn = false
	smallMenu.Parent = playerGui

	local smallButton = Instance.new("ImageButton")
	smallButton.Name = "AvatarButton"
	smallButton.Image = "rbxassetid://108648849330242"
	smallButton.Size = UDim2.new(0, 60, 0, 60)
	smallButton.Position = UDim2.new(0, 20, 0, 200)
	smallButton.BackgroundTransparency = 1
	smallButton.Active = true
	smallButton.Draggable = true
	smallButton.Parent = smallMenu

	-- ========== MENU LỚN ==========
	local mainMenu = Instance.new("Frame")
	mainMenu.Name = "MainMenu"
	mainMenu.Visible = false
	mainMenu.Size = UDim2.new(0, 420, 0, 280)
	mainMenu.Position = UDim2.new(0.3, 0, 0.3, 0)
	mainMenu.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
	mainMenu.BorderSizePixel = 0
	mainMenu.Active = true
	mainMenu.Draggable = true
	mainMenu.Parent = smallMenu

	-- Giao diện mềm mại
	local corner = Instance.new("UICorner")
	corner.CornerRadius = UDim.new(0, 12)
	corner.Parent = mainMenu

	local stroke = Instance.new("UIStroke")
	stroke.Thickness = 1
	stroke.Color = Color3.fromRGB(80, 80, 80)
	stroke.Parent = mainMenu

	-- Nút đóng
	local closeBtn = Instance.new("TextButton")
	closeBtn.Name = "CloseButton"
	closeBtn.Text = "X"
	closeBtn.Font = Enum.Font.GothamBold
	closeBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
	closeBtn.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
	closeBtn.Size = UDim2.new(0, 28, 0, 28)
	closeBtn.Position = UDim2.new(1, -34, 0, 6)
	closeBtn.Parent = mainMenu

	local cornerX = Instance.new("UICorner")
	cornerX.CornerRadius = UDim.new(0, 6)
	cornerX.Parent = closeBtn

	-- Thanh tiêu đề
	local title = Instance.new("TextLabel")
	title.Text = "✨ MENU ✨"
	title.Font = Enum.Font.GothamBold
	title.TextSize = 18
	title.TextColor3 = Color3.fromRGB(255, 255, 255)
	title.BackgroundTransparency = 1
	title.Size = UDim2.new(1, -40, 0, 30)
	title.Position = UDim2.new(0, 10, 0, 5)
	title.TextXAlignment = Enum.TextXAlignment.Left
	title.Parent = mainMenu

	-- ========== TAB ==========
	local tabHolder = Instance.new("Frame")
	tabHolder.Size = UDim2.new(0, 100, 1, -40)
	tabHolder.Position = UDim2.new(0, 10, 0, 40)
	tabHolder.BackgroundTransparency = 1
	tabHolder.Parent = mainMenu

	local pagesHolder = Instance.new("Frame")
	pagesHolder.Size = UDim2.new(1, -120, 1, -50)
	pagesHolder.Position = UDim2.new(0, 120, 0, 40)
	pagesHolder.BackgroundTransparency = 1
	pagesHolder.Parent = mainMenu

	local function createTab(name)
		local btn = Instance.new("TextButton")
		btn.Text = name
		btn.Font = Enum.Font.GothamBold
		btn.TextSize = 14
		btn.TextColor3 = Color3.fromRGB(255, 255, 255)
		btn.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
		btn.Size = UDim2.new(1, -10, 0, 30)
		btn.Position = UDim2.new(0, 0, 0, (#tabHolder:GetChildren() - 1) * 35)
		btn.Parent = tabHolder

		local cornerT = Instance.new("UICorner")
		cornerT.CornerRadius = UDim.new(0, 6)
		cornerT.Parent = btn

		local page = Instance.new("Frame")
		page.Name = name .. "Page"
		page.Size = UDim2.new(1, 0, 1, 0)
		page.Visible = false
		page.Parent = pagesHolder

		local label = Instance.new("TextLabel")
		label.Text = "Welcome to " .. name .. " section!"
		label.Font = Enum.Font.Gotham
		label.TextColor3 = Color3.fromRGB(255, 255, 255)
		label.TextSize = 16
		label.BackgroundTransparency = 1
		label.Size = UDim2.new(1, 0, 1, 0)
		label.Parent = page

		btn.MouseButton1Click:Connect(function()
			for _, other in ipairs(pagesHolder:GetChildren()) do
				other.Visible = false
			end
			page.Visible = true
		end)

		return btn, page
	end

	local mainTab = createTab("Main")
	local farmTab = createTab("Farm")
	local infoTab = createTab("Info")

	-- Mặc định hiển thị Main
	mainTab:Activate()
	pagesHolder:FindFirstChild("MainPage").Visible = true

	-- ========== KẾT NỐI ==========
	smallButton.MouseButton1Click:Connect(function()
		mainMenu.Visible = not mainMenu.Visible
	end)

	closeBtn.MouseButton1Click:Connect(function()
		mainMenu.Visible = false
	end)

	print("[MenuLibrary] Menu đã khởi tạo thành công.")
end

return MenuLibrary
